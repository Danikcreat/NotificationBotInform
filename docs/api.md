# API Overview

–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π backend Media Task Manager –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ **Express 4 + PostgreSQL (Supabase)**.  
–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ—Ç–¥–∞—é—Ç –∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç JSON, –æ—Ç–≤–µ—Ç—ã –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–µ `message`.  
–î–ª—è –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <JWT>` —Å —Ç–æ–∫–µ–Ω–æ–º, –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –ø—Ä–∏ –≤—Ö–æ–¥–µ.

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ò–º—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| --- | --- |
| `DATABASE_URL` | —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞). |
| `JWT_SECRET` | —Å–µ–∫—Ä–µ—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ —Ç–æ–∫–µ–Ω–æ–≤ (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω). |
| `PORT` | –ø–æ—Ä—Ç Express (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `4000`). |
| `DEFAULT_SUPER_ADMIN_*` | –Ω–∞–±–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∞–≤—Ç–æ-—Å–æ–∑–¥–∞–Ω–∏—è —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (`LOGIN`, `PASSWORD`, `FIRST_NAME`, `LAST_NAME`, –∏ —Ç.–¥.). |
| `BROADCAST_API_URL` | –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–∏—Å–∞ —Ä–∞—Å—Å—ã–ª–æ–∫/–±–æ—Ç–∞, –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º. |
| `BROADCAST_ACCESS_TOKEN` | —Ç–æ–∫–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `BROADCAST_API_URL`. |
| `PUBLIC_APP_URL` | –±–∞–∑–æ–≤—ã–π URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Å—ã–ª–æ–∫ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö. |
| `CONTENT_PLAN_RANGE_LIMIT_DAYS` | –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω `GET /api/content-plan` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 93 –¥–Ω—è). |
| `DB_POOL_*` / `PG_*` | –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (`max`, `idleTimeout`, `connectionTimeout`). |

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### `POST /api/auth/login`
–í—Ö–æ–¥ –ø–æ –ª–æ–≥–∏–Ω—É –∏ –ø–∞—Ä–æ–ª—é.

**–¢–µ–ª–æ**: `{ login, password }`  
**–û—Ç–≤–µ—Ç** `200 OK`: `{ token, user }`, –≥–¥–µ `user` ‚Äî –∑–∞–ø–∏—Å—å –±–µ–∑ –ø–∞—Ä–æ–ª—è.  
**–û—à–∏–±–∫–∏**: `400` (–ø—Ä–æ–ø—É—â–µ–Ω—ã –ø–æ–ª—è), `401` (–Ω–µ–≤–µ—Ä–Ω–∞—è –ø–∞—Ä–∞).

### `GET /api/auth/me`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ JWT.

**–û—Ç–≤–µ—Ç** `200 OK`: `{ user }`.  
**–û—à–∏–±–∫–∏**: `401` (–Ω–µ—Ç/–±–∏—Ç—ã–π —Ç–æ–∫–µ–Ω), `404` (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—ë–Ω).

## –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

–í—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ `super_admin` –∏ `admin`, –ø—Ä–∏—á—ë–º –∫–∞–∂–¥—ã–π –∞–¥–º–∏–Ω –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä–æ–ª–∏ –∏–∑ `getAssignableRoles(actorRole)`. –ü–∞—Ä–æ–ª—å –≤–∏–¥–µ–Ω —Ç–æ–ª—å–∫–æ —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞–º.

- `GET /api/users` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ –§–ò–û. –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø—Ä–∞–≤ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–µ `password`.
- `POST /api/users` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: `lastName`, `firstName`, `login`, `password`, `role`. –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–¥–∞—Ç—å `telegramUsername`, `telegramChatId`, `telegramOptIn`. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- `PUT /api/users/:id` ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–§–ò–û, –ª–æ–≥–∏–Ω, —Ä–æ–ª—å, –¥–æ–ª–∂–Ω–æ—Å—Ç—å, –≥—Ä—É–ø–ø–∞, Telegram-–ø–æ–ª—è).
- `DELETE /api/users/:id` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ.
- `POST /api/users/:id/reset-password` ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å (8 —Å–∏–º–≤–æ–ª–æ–≤), —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ user, password }`.
- `PUT /api/users/:id/telegram` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Telegram-–¥–∞–Ω–Ω—ã—Ö. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –¥–ª—è —Å–µ–±—è, –ª–∏–±–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å –ø—Ä–∞–≤–∞–º–∏ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –ª—é–±—ã–µ –ø–æ–ª—è (`telegramUsername`, `telegramChatId`, `telegramOptIn`).

## –ó–∞–¥–∞—á–∏ (`/api/tasks`)

–•—Ä–∞–Ω–µ–Ω–∏–µ –∏–¥—ë—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `tasks`: `id text PRIMARY KEY`, `payload jsonb`, `created_at timestamptz`, `updated_at timestamptz`. –°–µ—Ä–≤–µ—Ä –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è —á—Ç–µ–Ω–∏—è, –ø–æ—Å–∫–æ–ª—å–∫—É UI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç client-side —Ñ–∏–ª—å—Ç—Ä—ã; –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –∑–∞—â–∏—Ç–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã middleware‚Äô–æ–º.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–¥–∞—á–∏

```jsonc
{
  "id": "uuid",
  "title": "string",
  "description": "string",
  "deadline": "2025-12-31T12:00:00.000Z",
  "priority": "low|normal|high|urgent",
  "status": "todo|in_progress|done|archived",
  "responsible": "–§–ò–û –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è",
  "assignees": [
    { "name": "string", "login": "user_login", "telegramUsername": "...", "telegramChatId": "..." }
  ],
  "assigneeLogins": ["user_login"],
  "assigner": { "name": "...", "login": "...", "telegramUsername": "...", "telegramChatId": "..." },
  "attachments": [{ "id": "str", "label": "–ù–∞–∑–≤–∞–Ω–∏–µ", "url": "https://..." }],
  "subtasks": [{ "id": "str", "text": "–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å", "done": false }],
  "linkedContent": [ { "bucket": "instagram", "contentId": 42 } ],
  "createdAt": "ISO string",
  "updatedAt": "ISO string"
}
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

- `GET /api/tasks` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–¥–∞—á (—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `updated_at DESC`). –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–º–µ—à–∏–≤–∞—é—Ç—Å—è —Å–≤—è–∑–∏ —Å –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º–∏ (`linkedContent`).
- `GET /api/tasks/:id` ‚Äî –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞.
- `POST /api/tasks` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: `title`, `deadline`, `priority`, `status`, —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (`assignees[]` –∏–ª–∏ `responsible`). –°–µ—Ä–≤–µ—Ä:
  1. –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏;
  2. –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `id` –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏;
  3. –≤—ã—á–∏—Å–ª—è–µ—Ç `assigneeLogins`;
  4. –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ `BROADCAST_API_URL` (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ).
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—É—é –∑–∞–¥–∞—á—É.
- `PUT /api/tasks/:id` ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π. –ü–æ–ª—è `attachments`, `subtasks`, `assignees` –∑–∞–º–µ–Ω—è—é—Ç—Å—è —Ü–µ–ª–∏–∫–æ–º.
- `DELETE /api/tasks/:id` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ.

## –§–∏—á–∏ (`/api/features`)

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è product roadmap. –•—Ä–∞–Ω—è—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∑–∞–¥–∞—á–∞–º (—Ç–∞–±–ª–∏—Ü–∞ `features` + –∫–æ–ª–æ–Ω–∫–∞ `payload jsonb`).

- `GET /api/features` –∏ `GET /api/features/:id` ‚Äî —á—Ç–µ–Ω–∏–µ.
- `POST /api/features` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: `title`, `status`. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ: `description`, `eta`, `category`, `tags[]`, `baseVotes`.
- `PUT /api/features/:id` ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.
- `DELETE /api/features/:id` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ.

## –ö–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω

### –ë–∞–∫–µ—Ç—ã –∏ —Ç–∞–±–ª–∏—Ü—ã

| Bucket | –¢–∞–±–ª–∏—Ü–∞ | –ü–æ–ª—è | –ö—Ç–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç |
| --- | --- | --- | --- |
| `events` | `events` | `title`, `description?`, `date`, `time?`, `location?`, `type` | `super_admin`, `admin` |
| `instagram` | `content_instagram` | `title`, `description?`, `date`, `time`, `type`, `status`, `event_id?` | `super_admin`, `admin`, `content_manager` |
| `telegram` | `content_telegram` | –∫–∞–∫ —É instagram | `super_admin`, `admin`, `content_manager` |
| `youtube` | `content_youtube` | –∫–∞–∫ —É instagram, `type` ‚àà {`video`,`shorts`} | `super_admin`, `admin`, `content_manager` |

### –î–∏–∞–ø–∞–∑–æ–Ω

`GET /api/content-plan?month=12&year=2025` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç:

```jsonc
{
  "range": { "from": "2025-12-01", "to": "2025-12-31" },
  "events": [...],
  "instagram": [...],
  "telegram": [...],
  "youtube": [...]
}
```

–ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å `from`/`to`, –¥–∏–∞–ø–∞–∑–æ–Ω –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è `CONTENT_PLAN_RANGE_LIMIT_DAYS`. –î–ª—è –∫–∞–∂–¥–æ–≥–æ bucket –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç `id`, `title`, `date`, `time`, `status`, —Å–≤—è–∑—å —Å —Å–æ–±—ã—Ç–∏–µ–º –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è `createdAt/updatedAt`.

### CRUD

- `POST /api/content-plan/:bucket` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –±–∞–∫–µ—Ç–µ. –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –Ω–∞ bucket.
- `PUT /api/content-plan/:bucket/:id` ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ. `id` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º —Ü–µ–ª—ã–º.
- `DELETE /api/content-plan/:bucket/:id` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ.

### Assets –∏ –∑–∞–¥–∞—á–∏

| –ú–∞—Ä—à—Ä—É—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
| --- | --- |
| `GET /api/content-plan/:bucket/:id/assets` | —Å–ø–∏—Å–æ–∫ –≤–ª–æ–∂–µ–Ω–∏–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (`bucket != events`). |
| `POST /api/content-plan/:bucket/:id/assets` | —Å–æ–∑–¥–∞–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–∏—è `{ title, url?, notes? }`. |
| `DELETE /api/content-plan/:bucket/:id/assets/:assetId` | —É–¥–∞–ª–µ–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–∏—è. |
| `GET /api/content-plan/:bucket/:id/tasks` | –∑–∞–¥–∞—á–∏, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏. |
| `POST /api/content-plan/:bucket/:id/tasks` | –ø—Ä–∏–≤—è–∑–∫–∞ –∑–∞–¥–∞—á–∏ (`{ taskId }`), –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å–≤—è–∑–∏. |
| `DELETE /api/content-plan/:bucket/:id/tasks/:taskId` | –æ—Ç–≤—è–∑–∫–∞ –∑–∞–¥–∞—á–∏. |

–ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å, —Ä–∞–±–æ—Ç–∞—é—â–∏–π —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ bucket –∏ ID (`resolveContentItemRequest`). –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Ä–æ–ª–∏ —Å `CONTENT_PLAN_PERMISSIONS`.

## Health-check –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

- `GET /api/health` ‚Äî `{ status: "ok", timestamp }`.
- –ü–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è API —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑–¥–∞—ë—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏–∑ –∫–æ—Ä–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (`app.use(express.static(..))`) –∏ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –≤—Å–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –Ω–∞ `index.html`.

## –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π

–§—É–Ω–∫—Ü–∏—è `notifyAssigneesAboutTask` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–∏–¥–∞:

```
üîî –ü—Ä–∏–≤–µ—Ç!

–¢–µ–±–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∫–∞: ¬´–ù–∞–∑–≤–∞–Ω–∏–µ¬ª
‚è∞ –î–µ–¥–ª–∞–π–Ω: 31 –¥–µ–∫ 14:00

–ù–µ –∑–∞–±—É–¥—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –µ—ë –≤ —Å—Ä–æ–∫! –Ø —Ç–µ–±–µ –Ω–∞–ø–æ–º–Ω—é üòà
üîó <a href="https://.../index.html#task=...">–°—Å—ã–ª–∫–∞</a>
```

–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è POST-–∑–∞–ø—Ä–æ—Å–æ–º –Ω–∞ `BROADCAST_API_URL` —Å —Ç–µ–ª–æ–º `{ message, logins }`, –≥–¥–µ `logins` ‚Äî —Å–ø–∏—Å–æ–∫ –ª–æ–≥–∏–Ω–æ–≤ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π. –ï—Å–ª–∏ `BROADCAST_API_URL` –ø—É—Å—Ç, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è.

## –°—Ö–µ–º–∞ –±–∞–∑—ã

| –¢–∞–±–ª–∏—Ü–∞ | –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
| --- | --- | --- |
| `users` | `id bigserial PK`, –§–ò–û, `login UNIQUE`, `password`, `role`, `position`, `group_number`, `telegram_username`, `telegram_chat_id`, `telegram_opt_in boolean NOT NULL DEFAULT false`, `created_at`, `updated_at` | —Å–º. `docs/roles-and-users.md` –¥–ª—è —Ä–æ–ª–µ–π –∏ –ø—Ä–∞–≤–∏–ª. |
| `tasks` | `id text PK`, `payload jsonb NOT NULL`, `created_at timestamptz`, `updated_at timestamptz` | —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏. |
| `features` | `id text PK`, `payload jsonb NOT NULL`, `created_at timestamptz`, `updated_at timestamptz` | product roadmap. |
| `events` | `id serial PK`, `title`, `description`, `date`, `time`, `location`, `type`, `created_at`, `updated_at` | –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω–µ. |
| `content_instagram` / `content_telegram` / `content_youtube` | –ø–æ–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π + `status`, `event_id`, `created_at`, `updated_at` | `content_youtube.type` –æ–≥—Ä–∞–Ω–∏—á–µ–Ω `video/shorts`. |
| `content_assets` | `id bigserial PK`, `channel text`, `content_id integer`, `title`, `url`, `notes`, timestamps | `channel` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –±–∞–∫–µ—Ç—É. |
| `content_task_links` | `id bigserial PK`, `task_id text FK`, `channel text`, `content_id integer`, timestamps, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å | –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–≤—è–∑—å –∑–∞–¥–∞—á —Å –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º–∏; `ON DELETE CASCADE` –ø–æ `task_id`. |

–≠—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ Supabase / SQL-—Å–∫—Ä–∏–ø—Ç–∞–º–∏ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ `sql/`.
